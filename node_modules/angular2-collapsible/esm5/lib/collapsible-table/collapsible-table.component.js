/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, Input, HostBinding, HostListener, ElementRef, ContentChildren } from '@angular/core';
import { CollapsibleTableRowComponent } from '../collapsible-table-row/collapsible-table-row.component';
import { CollapsibleService } from '../services/collapsible.service';
var CollapsibleTableComponent = /** @class */ (function () {
    function CollapsibleTableComponent(el, collapsibleService) {
        this.el = el;
        this.collapsibleService = collapsibleService;
        // allows navigation between table rows using arrow keys
        this.allowKeyboardNavigation = true;
        this.fixedTableHeight = 'auto';
        this.tabindex = 0;
        this.selectedRows = [];
        // specifies collapsible type. Can be either 'accordion' or 'expandable'
        this.type = 'accordion';
        this.mouseDownHold = false;
    }
    /**
     * @return {?}
     */
    CollapsibleTableComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    CollapsibleTableComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        // this.updateFixedTableHeight();
        /*
                LOG(`CollapsibleTableComponent::ngOnInit()\n` +
                    `this = {\n` +
                    `bordered = ${this.bordered}\n` +
                    `borderedHorizontally = ${this.borderedHorizontally}\n` +
                    `borderedVertically = ${this.borderedVertically}\n` +
                    `striped = ${this.striped}\n` +
                    `stripedOddColor = ${this.stripedOddColor}\n` +
                    `stripedEvenColor = ${this.stripedEvenColor}\n` +
                    `highlight = ${this.highlight}\n` +
                    `highlightColor = ${this.highlightColor}\n` +
                    `highlightTextColor = ${this.highlightTextColor}\n` +
                    `activeColor = ${this.activeColor}\n` +
                    `activeTextColor = ${this.activeTextColor}\n` +
                    `centered = ${this.centered}\n` +
                    `responsive = ${this.responsive}\n` +
                    `select = ${this.select}\n` +
                    `selectColor = ${this.selectColor}\n` +
                    `selectTextColor = ${this.selectTextColor}\n` +
                    `selectMultipleRows = ${this.selectMultipleRows}\n` +
                    `noTextSelect = ${this.noTextSelect}\n` +
                    `}`);
                    */
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    CollapsibleTableComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        for (var change in changes) {
            if (changes.hasOwnProperty(change)) {
                if (this.collapsibleTableRows != null) {
                    switch (change) {
                        case 'striped':
                        case 'stripedOddColor':
                        case 'stripedOddTextColor':
                        case 'stripedEvenColor':
                        case 'stripedEvenTextColor':
                            this.updateTable('striped');
                            break;
                        case 'highlight':
                        case 'highlightColor':
                        case 'highlightTextColor':
                            this.updateTable('highlight');
                            break;
                        case 'activeColor':
                        case 'activeTextColor':
                            this.updateTable('active');
                            break;
                        case 'select':
                        case 'selectColor':
                        case 'selectTextColor':
                        case 'selectMultipleRows':
                        case 'allowDeselectingRows':
                            this.updateTable('select');
                            break;
                    }
                }
                // update collapsible table type in CollapsibleService
                if (change === 'type') {
                    this.type = changes["type"].currentValue;
                    this.collapsibleService.setType(this.type);
                }
            }
        }
        this.collapsibleService.setCollapsibleTable(this);
    };
    /**
     * @return {?}
     */
    CollapsibleTableComponent.prototype.focus = /**
     * @return {?}
     */
    function () {
        this.el.nativeElement.focus();
    };
    /**
     * @param {?} index
     * @return {?}
     */
    CollapsibleTableComponent.prototype.addSelectedRow = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        switch (true) {
            case this.selectMultipleRows && this.selectedRows.indexOf(index) === -1:
                this.selectedRows.push(index);
                this.selectedRows.sort(function (a, b) { return a - b; });
                break;
            case !this.selectMultipleRows:
                this.selectedRows = [];
                this.deselectAllRows();
                this.selectedRows.push(index);
                this.selectedRows.sort(function (a, b) { return a - b; });
                break;
        }
    };
    /**
     * @param {?} index
     * @return {?}
     */
    CollapsibleTableComponent.prototype.removeSelectedRow = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        if (this.selectedRows.indexOf(index) !== -1) {
            this.selectedRows.splice(this.selectedRows.indexOf(index), 1);
        }
    };
    /**
     * @return {?}
     */
    CollapsibleTableComponent.prototype.clearSelectedRows = /**
     * @return {?}
     */
    function () {
        this.selectedRows = [];
    };
    /**
     * @return {?}
     */
    CollapsibleTableComponent.prototype.deselectAllRows = /**
     * @return {?}
     */
    function () {
        this.collapsibleTableRows.forEach(function (row) {
            row.selected = false;
            row.updateRow();
        });
    };
    /**
     * @param {?} index
     * @return {?}
     */
    CollapsibleTableComponent.prototype.selectRow = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        var _this = this;
        if (this.select) {
            switch (true) {
                case index === 0:
                    this.selectRow(1);
                    break;
                case index === this.collapsibleTableRows.length:
                    this.selectRow(this.collapsibleTableRows.length - 1);
                    break;
                case 0 < index && index <= this.collapsibleTableRows.length - 1:
                    this.addSelectedRow(index);
                    this.collapsibleTableRows.forEach(function (row, i) {
                        if (index !== i) {
                            if (!_this.selectMultipleRows) {
                                row.selected = false;
                            }
                        }
                        else {
                            row.selected = true;
                        }
                        row.updateRow();
                    });
                    break;
            }
        }
    };
    /**
     * @param {?} firstRowIndex
     * @param {?} lastRowIndex
     * @return {?}
     */
    CollapsibleTableComponent.prototype.selectRows = /**
     * @param {?} firstRowIndex
     * @param {?} lastRowIndex
     * @return {?}
     */
    function (firstRowIndex, lastRowIndex) {
        var _this = this;
        if (this.selectMultipleRows &&
            0 < firstRowIndex && firstRowIndex < lastRowIndex &&
            lastRowIndex <= this.collapsibleTableRows.length - 1) {
            this.clearSelectedRows();
            this.collapsibleTableRows.forEach(function (row, i) {
                if (firstRowIndex <= i && i <= lastRowIndex) {
                    _this.addSelectedRow(i);
                    row.selected = true;
                }
                else {
                    row.selected = false;
                }
                row.updateRow();
            });
        }
    };
    /**
     * @param {?} index
     * @return {?}
     */
    CollapsibleTableComponent.prototype.toggleRowSelection = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        var _this = this;
        if (this.select &&
            0 < index && index <= this.collapsibleTableRows.length - 1) {
            this.collapsibleTableRows.forEach(function (row, i) {
                if (index === i) {
                    if (row.selected) {
                        _this.removeSelectedRow(index);
                    }
                    else {
                        _this.addSelectedRow(index);
                    }
                    row.selected = !row.selected;
                    row.updateRow();
                }
            });
        }
    };
    /*updateFixedTableHeight() {
        this.fixedTableHeight = this.el.nativeElement.offsetHeight + 'px';
        let elem: Element = this.el.nativeElement;
        let rowHeights = 0;
        if (this.collapsibleTableRowComponent != null) {
            this.collapsibleTableRowComponent.forEach(row => {
            });
        }
    }*/
    /**
     * @param {?} row
     * @return {?}
     */
    CollapsibleTableComponent.prototype.updateStriped = /**
     * @param {?} row
     * @return {?}
     */
    function (row) {
        if (this.striped && row.isBodyRow) {
            row.isParentStriped = true;
            if (row.isOddRow) {
                row.parentStripedRowBackgroundColor = this.stripedOddColor || CollapsibleTableRowComponent.DEFAULT_STRIPED_ODD_ROW_COLOR;
                row.parentStripedRowTextColor = this.stripedOddTextColor || CollapsibleTableRowComponent.DEFAULT_ROW_TEXT_COLOR;
                row.rowBackgroundColor = row.parentStripedRowBackgroundColor;
                row.rowTextColor = row.parentStripedRowTextColor;
            }
            else {
                row.parentStripedRowBackgroundColor = this.stripedEvenColor || CollapsibleTableRowComponent.DEFAULT_STRIPED_EVEN_ROW_COLOR;
                row.parentStripedRowTextColor = this.stripedEvenTextColor || CollapsibleTableRowComponent.DEFAULT_ROW_TEXT_COLOR;
                row.rowBackgroundColor = row.parentStripedRowBackgroundColor;
                row.rowTextColor = row.parentStripedRowTextColor;
            }
        }
        else {
            row.isParentStriped = false;
            row.rowBackgroundColor = undefined;
            row.rowTextColor = undefined;
        }
    };
    /**
     * @param {?} row
     * @return {?}
     */
    CollapsibleTableComponent.prototype.updateHighlight = /**
     * @param {?} row
     * @return {?}
     */
    function (row) {
        row.isParentHighlight = this.highlight;
        row.parentHighlightRowBackgroundColor = this.highlightColor || CollapsibleTableRowComponent.DEFAULT_HIGHLIGHT_ROW_COLOR;
        row.parentHighlightRowTextColor = this.highlightTextColor || CollapsibleTableRowComponent.DEFAULT_ROW_TEXT_COLOR;
    };
    /**
     * @param {?} row
     * @return {?}
     */
    CollapsibleTableComponent.prototype.updateActive = /**
     * @param {?} row
     * @return {?}
     */
    function (row) {
        row.activeRowBackgroundColor = this.activeColor || CollapsibleTableRowComponent.DEFAULT_ACTIVE_ROW_COLOR;
        row.activeRowTextColor = this.activeTextColor || CollapsibleTableRowComponent.DEFAULT_ROW_TEXT_COLOR;
    };
    /**
     * @param {?} row
     * @return {?}
     */
    CollapsibleTableComponent.prototype.updateSelect = /**
     * @param {?} row
     * @return {?}
     */
    function (row) {
        row.parentAllowsSelect = this.select;
        row.parentAllowsSelectMultipleRows = this.selectMultipleRows;
        row.parentAllowsDeselectingRows = this.allowDeselectingRows;
        if (row.selected) {
            row.selectedRowBackgroundColor = this.selectColor || CollapsibleTableRowComponent.DEFAULT_SELECTED_ROW_COLOR;
            row.selectedRowTextColor = this.selectTextColor || CollapsibleTableRowComponent.DEFAULT_ROW_TEXT_COLOR;
            row.rowBackgroundColor = row.selectedRowBackgroundColor;
            row.rowTextColor = row.selectedRowTextColor;
        }
    };
    /**
     * @param {?=} change
     * @return {?}
     */
    CollapsibleTableComponent.prototype.updateTable = /**
     * @param {?=} change
     * @return {?}
     */
    function (change) {
        var _this = this;
        if (this.collapsibleTableRows != null) {
            if (change != null) {
                switch (change) {
                    case 'striped':
                        // propagate changes to each of the CollapsibleTableRowComponent children
                        this.collapsibleTableRows.forEach(function (row) { _this.updateStriped(row); });
                        break;
                    case 'highlight':
                        this.collapsibleTableRows.forEach(function (row) { _this.updateHighlight(row); });
                        break;
                    case 'active':
                        this.collapsibleTableRows.forEach(function (row) { _this.updateActive(row); });
                        break;
                    case 'select':
                        this.collapsibleTableRows.forEach(function (row) { _this.updateSelect(row); });
                        break;
                }
            }
            else {
                // propagate changes to each of the CollapsibleTableRowComponent children
                this.collapsibleTableRows.forEach(function (row) {
                    _this.updateStriped(row);
                    _this.updateHighlight(row);
                    _this.updateSelect(row);
                    _this.updateActive(row);
                });
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    CollapsibleTableComponent.prototype.keydown = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        // select a row only if 'select' property is set to 'true'
        if (this.select && this.allowKeyboardNavigation) {
            /** @enum {number} */
            var Key = {
                arrowUp: 38,
                arrowDown: 40,
                home: 36,
                end: 35,
            };
            Key[Key.arrowUp] = 'arrowUp';
            Key[Key.arrowDown] = 'arrowDown';
            Key[Key.home] = 'home';
            Key[Key.end] = 'end';
            /** @type {?} */
            var index = 1;
            /** @type {?} */
            var whichKey = event['which'];
            if (Key[whichKey] != null) {
                event.preventDefault();
                event.stopPropagation();
                switch (whichKey) {
                    case Key.arrowUp:
                        // select previous row
                        if (this.selectedRows.length > 0) {
                            index = this.selectedRows[this.selectedRows.length - 1];
                            index--;
                        }
                        break;
                    case Key.arrowDown:
                        // select next row
                        if (this.selectedRows.length > 0) {
                            index = this.selectedRows[this.selectedRows.length - 1];
                            index++;
                        }
                        break;
                    case Key.home:
                        index = 1;
                        break;
                    case Key.end:
                        index = this.collapsibleTableRows.length - 1;
                        break;
                }
                this.clearSelectedRows();
                this.deselectAllRows();
                this.selectRow(index);
                this.updateTable();
            }
        }
    };
    /**
     * @return {?}
     */
    CollapsibleTableComponent.prototype.mousedown = /**
     * @return {?}
     */
    function () {
        this.mouseDownHold = true;
    };
    /**
     * @return {?}
     */
    CollapsibleTableComponent.prototype.mouseup = /**
     * @return {?}
     */
    function () {
        this.mouseDownHold = false;
    };
    CollapsibleTableComponent.decorators = [
        { type: Component, args: [{
                    selector: 'collapsible-table',
                    template: "<ng-content></ng-content>",
                    providers: [
                        CollapsibleService
                    ],
                    styles: ["\n        :host {\n            display: table;\n            position: relative;\n            width: 100%;\n            border-collapse: collapse;\n        }\n\n        :host thead {\n            border-bottom: 1px solid #d0d0d0;\n        }\n\n        :host /deep/ tbody /deep/ collapsible-table-row {\n            cursor: pointer;\n        }\n\n        :host /deep/ collapsible-table-row th,\n        :host /deep/ collapsible-table-row td {\n            border-radius: 0;\n        }\n\n        :host[bordered='true'] {\n            border-top: 1px solid #d0d0d0;\n            border-right: 1px solid #d0d0d0;\n            border-left: 1px solid #d0d0d0;\n        }\n\n        :host[bordered='true'] /deep/ collapsible-table-row,\n        :host[borderedHorizontally='true'] /deep/ collapsible-table-row {\n            border-bottom: 1px solid #d0d0d0;\n        }\n\n        :host[bordered='true'] /deep/ collapsible-table-row th,\n        :host[bordered='true'] /deep/ collapsible-table-row td,\n        :host[borderedVertically='true'] /deep/ collapsible-table-row th:not(:last-child),\n        :host[borderedVertically='true'] /deep/ collapsible-table-row td:not(:last-child) {\n            border-right: 1px solid #d0d0d0;\n        }\n\n        :host(.centered) /deep/ * {\n            text-align: center;\n        }\n\n        :host(.noTextSelect) /deep/ collapsible-table-row th,\n        :host(.noTextSelect) /deep/ collapsible-table-row td {\n            user-select: none;\n        }\n    "]
                }] }
    ];
    /** @nocollapse */
    CollapsibleTableComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: CollapsibleService }
    ]; };
    CollapsibleTableComponent.propDecorators = {
        bordered: [{ type: Input }, { type: HostBinding, args: ['attr.bordered',] }],
        borderedHorizontally: [{ type: Input }, { type: HostBinding, args: ['attr.borderedHorizontally',] }],
        borderedVertically: [{ type: Input }, { type: HostBinding, args: ['attr.borderedVertically',] }],
        striped: [{ type: Input }, { type: HostBinding, args: ['attr.striped',] }],
        stripedOddColor: [{ type: Input }, { type: HostBinding, args: ['attr.stripedOddColor',] }],
        stripedOddTextColor: [{ type: Input }, { type: HostBinding, args: ['attr.stripedOddTextColor',] }],
        stripedEvenColor: [{ type: Input }, { type: HostBinding, args: ['attr.stripedEvenColor',] }],
        stripedEvenTextColor: [{ type: Input }, { type: HostBinding, args: ['attr.stripedEvenTextColor',] }],
        highlight: [{ type: Input }, { type: HostBinding, args: ['attr.highlight',] }],
        highlightColor: [{ type: Input }, { type: HostBinding, args: ['attr.highlightColor',] }],
        highlightTextColor: [{ type: Input }, { type: HostBinding, args: ['attr.highlightTextColor',] }],
        activeColor: [{ type: Input }, { type: HostBinding, args: ['attr.activeColor',] }],
        activeTextColor: [{ type: Input }, { type: HostBinding, args: ['attr.activeTextColor',] }],
        centered: [{ type: Input }, { type: HostBinding, args: ['class.centered',] }, { type: HostBinding, args: ['attr.centered',] }],
        responsive: [{ type: Input }, { type: HostBinding, args: ['attr.responsive',] }],
        select: [{ type: Input }, { type: HostBinding, args: ['attr.select',] }],
        selectMultipleRows: [{ type: Input }, { type: HostBinding, args: ['attr.selectMultipleRows',] }],
        selectColor: [{ type: Input }, { type: HostBinding, args: ['attr.selectColor',] }],
        selectTextColor: [{ type: Input }, { type: HostBinding, args: ['attr.selectTextColor',] }],
        allowDeselectingRows: [{ type: Input }, { type: HostBinding, args: ['attr.allowDeselectingRows',] }],
        allowKeyboardNavigation: [{ type: Input }, { type: HostBinding, args: ['attr.allowKeyboardNavigation',] }],
        noTextSelect: [{ type: Input }, { type: HostBinding, args: ['class.noTextSelect',] }, { type: HostBinding, args: ['attr.noTextSelect',] }],
        tabindex: [{ type: HostBinding, args: ['attr.tabindex',] }],
        type: [{ type: Input }, { type: HostBinding, args: ['attr.type',] }],
        collapsibleTableRows: [{ type: ContentChildren, args: [CollapsibleTableRowComponent,] }],
        keydown: [{ type: HostListener, args: ['keydown', ['$event'],] }],
        mousedown: [{ type: HostListener, args: ['mousedown',] }],
        mouseup: [{ type: HostListener, args: ['mouseup',] }]
    };
    return CollapsibleTableComponent;
}());
export { CollapsibleTableComponent };
if (false) {
    /** @type {?} */
    CollapsibleTableComponent.prototype.bordered;
    /** @type {?} */
    CollapsibleTableComponent.prototype.borderedHorizontally;
    /** @type {?} */
    CollapsibleTableComponent.prototype.borderedVertically;
    /** @type {?} */
    CollapsibleTableComponent.prototype.striped;
    /** @type {?} */
    CollapsibleTableComponent.prototype.stripedOddColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.stripedOddTextColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.stripedEvenColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.stripedEvenTextColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.highlight;
    /** @type {?} */
    CollapsibleTableComponent.prototype.highlightColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.highlightTextColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.activeColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.activeTextColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.centered;
    /** @type {?} */
    CollapsibleTableComponent.prototype.responsive;
    /** @type {?} */
    CollapsibleTableComponent.prototype.select;
    /** @type {?} */
    CollapsibleTableComponent.prototype.selectMultipleRows;
    /** @type {?} */
    CollapsibleTableComponent.prototype.selectColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.selectTextColor;
    /** @type {?} */
    CollapsibleTableComponent.prototype.allowDeselectingRows;
    /** @type {?} */
    CollapsibleTableComponent.prototype.allowKeyboardNavigation;
    /** @type {?} */
    CollapsibleTableComponent.prototype.noTextSelect;
    /** @type {?} */
    CollapsibleTableComponent.prototype.fixedTableHeight;
    /** @type {?} */
    CollapsibleTableComponent.prototype.tabindex;
    /** @type {?} */
    CollapsibleTableComponent.prototype.selectedRows;
    /** @type {?} */
    CollapsibleTableComponent.prototype.type;
    /** @type {?} */
    CollapsibleTableComponent.prototype.collapsibleTableRows;
    /** @type {?} */
    CollapsibleTableComponent.prototype.mouseDownHold;
    /** @type {?} */
    CollapsibleTableComponent.prototype.el;
    /** @type {?} */
    CollapsibleTableComponent.prototype.collapsibleService;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sbGFwc2libGUtdGFibGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vYW5ndWxhcjItY29sbGFwc2libGUvIiwic291cmNlcyI6WyJsaWIvY29sbGFwc2libGUtdGFibGUvY29sbGFwc2libGUtdGFibGUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUVULEtBQUssRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUNoQyxVQUFVLEVBQUUsZUFBZSxFQUM5QixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSwwREFBMEQsQ0FBQztBQUN4RyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQzs7SUFxS2pFLG1DQUNZLElBQ0E7UUFEQSxPQUFFLEdBQUYsRUFBRTtRQUNGLHVCQUFrQixHQUFsQixrQkFBa0I7O3VDQXZCSixJQUFJO2dDQU9YLE1BQU07d0JBRWdCLENBQUM7NEJBRVosRUFBRTs7b0JBSTZCLFdBQVc7NkJBSXhELEtBQUs7S0FJa0M7Ozs7SUFFdkQsNENBQVE7OztJQUFSO0tBQ0M7Ozs7SUFFRCxzREFBa0I7OztJQUFsQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztLQXlCQzs7Ozs7SUFFRCwrQ0FBVzs7OztJQUFYLFVBQVksT0FBc0I7UUFDOUIsS0FBSyxJQUFNLE1BQU0sSUFBSSxPQUFPLEVBQUU7WUFDMUIsSUFBSSxPQUFPLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUNoQyxJQUFJLElBQUksQ0FBQyxvQkFBb0IsSUFBSSxJQUFJLEVBQUU7b0JBQ25DLFFBQVEsTUFBTSxFQUFFO3dCQUNaLEtBQUssU0FBUyxDQUFDO3dCQUNmLEtBQUssaUJBQWlCLENBQUM7d0JBQ3ZCLEtBQUsscUJBQXFCLENBQUM7d0JBQzNCLEtBQUssa0JBQWtCLENBQUM7d0JBQ3hCLEtBQUssc0JBQXNCOzRCQUN2QixJQUFJLENB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S0FBSyxZQUNMLFdBQVcsU0FBQyxrQkFBa0I7a0NBRzlCLEtBQUssWUFDTCxXQUFXLFNBQUMsc0JBQXNCO3VDQUdsQyxLQUFLLFlBQ0wsV0FBVyxTQUFDLDJCQUEyQjswQ0FHdkMsS0FBSyxZQUNMLFdBQVcsU0FBQyw4QkFBOEI7K0JBSTFDLEtBQUssWUFDTCxXQUFXLFNBQUMsb0JBQW9CLGNBQ2hDLFdBQVcsU0FBQyxtQkFBbUI7MkJBSS9CLFdBQVcsU0FBQyxlQUFlO3VCQUszQixLQUFLLFlBQ0wsV0FBVyxTQUFDLFdBQVc7dUNBRXZCLGVBQWUsU0FBQyw0QkFBNEI7MEJBb1E1QyxZQUFZLFNBQUMsU0FBUyxFQUFFLENBQUMsUUFBUSxDQUFDOzRCQWlEbEMsWUFBWSxTQUFDLFdBQVc7MEJBS3hCLFlBQVksU0FBQyxTQUFTOztvQ0FuZTNCOztTQWlFYSx5QkFBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIENvbXBvbmVudCxcbiAgICBPbkluaXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgQWZ0ZXJDb250ZW50SW5pdCxcbiAgICBJbnB1dCwgSG9zdEJpbmRpbmcsIEhvc3RMaXN0ZW5lcixcbiAgICBFbGVtZW50UmVmLCBDb250ZW50Q2hpbGRyZW5cbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IENvbGxhcHNpYmxlVGFibGVSb3dDb21wb25lbnQgfSBmcm9tICcuLi9jb2xsYXBzaWJsZS10YWJsZS1yb3cvY29sbGFwc2libGUtdGFibGUtcm93LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBDb2xsYXBzaWJsZVNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9jb2xsYXBzaWJsZS5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdjb2xsYXBzaWJsZS10YWJsZScsXG4gICAgdGVtcGxhdGU6IGA8bmctY29udGVudD48L25nLWNvbnRlbnQ+YCxcbiAgICBzdHlsZXM6IFtgXG4gICAgICAgIDpob3N0IHtcbiAgICAgICAgICAgIGRpc3BsYXk6IHRhYmxlO1xuICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgOmhvc3QgdGhlYWQge1xuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNkMGQwZDA7XG4gICAgICAgIH1cblxuICAgICAgICA6aG9zdCAvZGVlcC8gdGJvZHkgL2RlZXAvIGNvbGxhcHNpYmxlLXRhYmxlLXJvdyB7XG4gICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIH1cblxuICAgICAgICA6aG9zdCAvZGVlcC8gY29sbGFwc2libGUtdGFibGUtcm93IHRoLFxuICAgICAgICA6aG9zdCAvZGVlcC8gY29sbGFwc2libGUtdGFibGUtcm93IHRkIHtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDA7XG4gICAgICAgIH1cblxuICAgICAgICA6aG9zdFtib3JkZXJlZD0ndHJ1ZSddIHtcbiAgICAgICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjZDBkMGQwO1xuICAgICAgICAgICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgI2QwZDBkMDtcbiAgICAgICAgICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI2QwZDBkMDtcbiAgICAgICAgfVxuXG4gICAgICAgIDpob3N0W2JvcmRlcmVkPSd0cnVlJ10gL2RlZXAvIGNvbGxhcHNpYmxlLXRhYmxlLXJvdyxcbiAgICAgICAgOmhvc3RbYm9yZGVyZWRIb3Jpem9udGFsbHk9J3RydWUnXSAvZGVlcC8gY29sbGFwc2libGUtdGFibGUtcm93IHtcbiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZDBkMGQwO1xuICAgICAgICB9XG5cbiAgICAgICAgOmhvc3RbYm9yZGVyZWQ9J3RydWUnXSAvZGVlcC8gY29sbGFwc2libGUtdGFibGUtcm93IHRoLFxuICAgICAgICA6aG9zdFtib3JkZXJlZD0ndHJ1ZSddIC9kZWVwLyBjb2xsYXBzaWJsZS10YWJsZS1yb3cgdGQsXG4gICAgICAgIDpob3N0W2JvcmRlcmVkVmVydGljYWxseT0ndHJ1ZSddIC9kZWVwLyBjb2xsYXBzaWJsZS10YWJsZS1yb3cgdGg6bm90KDpsYXN0LWNoaWxkKSxcbiAgICAgICAgOmhvc3RbYm9yZGVyZWRWZXJ0aWNhbGx5PSd0cnVlJ10gL2RlZXAvIGNvbGxhcHNpYmxlLXRhYmxlLXJvdyB0ZDpub3QoOmxhc3QtY2hpbGQpIHtcbiAgICAgICAgICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNkMGQwZDA7XG4gICAgICAgIH1cblxuICAgICAgICA6aG9zdCguY2VudGVyZWQpIC9kZWVwLyAqIHtcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIDpob3N0KC5ub1RleHRTZWxlY3QpIC9kZWVwLyBjb2xsYXBzaWJsZS10YWJsZS1yb3cgdGgsXG4gICAgICAgIDpob3N0KC5ub1RleHRTZWxlY3QpIC9kZWVwLyBjb2xsYXBzaWJsZS10YWJsZS1yb3cgdGQge1xuICAgICAgICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gICAgICAgIH1cbiAgICBgXSxcbiAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgQ29sbGFwc2libGVTZXJ2aWNlXG4gICAgXVxufSlcbmV4cG9ydCBjbGFzcyBDb2xsYXBzaWJsZVRhYmxlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIEFmdGVyQ29udGVudEluaXQge1xuICAgIC8vIGNvbXBvbmVudCBvcHRpb25zXG4gICAgLy9cbiAgICAvLyBtYWtlcyB0aGUgdGFibGUgYm9yZGVyZWRcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5ib3JkZXJlZCcpIGJvcmRlcmVkOiBib29sZWFuO1xuXG4gICAgLy8gbWFrZXMgdGhlIHRhYmxlIGJvcmRlcmVkIGhvcml6b250YWxseSBvbmx5XG4gICAgQElucHV0KClcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuYm9yZGVyZWRIb3Jpem9udGFsbHknKSBib3JkZXJlZEhvcml6b250YWxseTogYm9vbGVhbjtcblxuICAgIC8vIG1ha2VzIHRoZSB0YWJsZSBib3JkZXJlZCB2ZXJ0aWNhbGx5IG9ubHlcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5ib3JkZXJlZFZlcnRpY2FsbHknKSBib3JkZXJlZFZlcnRpY2FsbHk6IGJvb2xlYW47XG5cbiAgICAvLyBtYWtlcyB0aGUgdGFibGUgc3RyaXBlZFxuICAgIEBJbnB1dCgpXG4gICAgQEhvc3RCaW5kaW5nKCdhdHRyLnN0cmlwZWQnKSBzdHJpcGVkOiBib29sZWFuO1xuXG4gICAgLy8gYSBjb2xvciBvZiBhbiBvZGQgc3RyaXBlZCByb3dcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5zdHJpcGVkT2RkQ29sb3InKSBzdHJpcGVkT2RkQ29sb3I6IHN0cmluZztcblxuICAgIC8vIGEgdGV4dCBjb2xvciBvZiBhbiBvZGQgc3RyaXBlZCByb3dcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5zdHJpcGVkT2RkVGV4dENvbG9yJykgc3RyaXBlZE9kZFRleHRDb2xvcjogc3RyaW5nO1xuXG4gICAgLy8gYSBjb2xvciBvZiBhbiBldmVuIHN0cmlwZWQgcm93XG4gICAgQElucHV0KClcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuc3RyaXBlZEV2ZW5Db2xvcicpIHN0cmlwZWRFdmVuQ29sb3I6IHN0cmluZztcblxuICAgIC8vIGEgdGV4dCBjb2xvciBvZiBhbiBldmVuIHN0cmlwZWQgcm93XG4gICAgQElucHV0KClcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuc3RyaXBlZEV2ZW5UZXh0Q29sb3InKSBzdHJpcGVkRXZlblRleHRDb2xvcjogc3RyaW5nO1xuXG4gICAgLy8gaGlnaGxpZ2h0IHRhYmxlIHJvd3Mgb24gbW91c2UgaG92ZXJcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5oaWdobGlnaHQnKSBoaWdobGlnaHQ6IGJvb2xlYW47XG5cbiAgICAvLyBhIGNvbG9yIG9mIGEgaGlnaGxpZ2h0ZWQgcm93XG4gICAgQElucHV0KClcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuaGlnaGxpZ2h0Q29sb3InKSBoaWdobGlnaHRDb2xvcjogc3RyaW5nO1xuXG4gICAgLy8gYSB0ZXh0IGNvbG9yIG9mIGEgaGlnaGxpZ2h0ZWQgcm93XG4gICAgQElucHV0KClcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuaGlnaGxpZ2h0VGV4dENvbG9yJykgaGlnaGxpZ2h0VGV4dENvbG9yOiBzdHJpbmc7XG5cbiAgICAvLyBhIGNvbG9yIG9mIGFuIGFjdGl2ZSByb3dcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5hY3RpdmVDb2xvcicpIGFjdGl2ZUNvbG9yOiBzdHJpbmc7XG5cbiAgICAvLyBhIHRleHQgY29sb3Igb2YgYW4gYWN0aXZlIHJvd1xuICAgIEBJbnB1dCgpXG4gICAgQEhvc3RCaW5kaW5nKCdhdHRyLmFjdGl2ZVRleHRDb2xvcicpIGFjdGl2ZVRleHRDb2xvcjogc3RyaW5nO1xuXG4gICAgLy8gY2VudGVyIGFsaWduIGFsbCB0aGUgdGV4dCBpbiB0aGUgdGFibGVcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuY2VudGVyZWQnKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5jZW50ZXJlZCcpIGNlbnRlcmVkOiBib29sZWFuO1xuXG4gICAgLy8gbWFrZXMgdGhlIHRhYmxlIGhvcml6b250YWxseSBzY3JvbGxhYmxlIG9uIHNtYWxsZXIgc2NyZWVuIHdpZHRoc1xuICAgIEBJbnB1dCgpXG4gICAgQEhvc3RCaW5kaW5nKCdhdHRyLnJlc3BvbnNpdmUnKSByZXNwb25zaXZlOiBib29sZWFuO1xuXG4gICAgLy8gYWxsb3dzIHRvIHNlbGVjdCByb3dzXG4gICAgQElucHV0KClcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuc2VsZWN0Jykgc2VsZWN0OiBib29sZWFuO1xuXG4gICAgLy8gYWxsb3dzIHRvIHNlbGVjdCBtdWx0aXBsZSByb3dzXG4gICAgQElucHV0KClcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuc2VsZWN0TXVsdGlwbGVSb3dzJykgc2VsZWN0TXVsdGlwbGVSb3dzOiBib29sZWFuO1xuXG4gICAgLy8gYSBjb2xvciBvZiBhIHNlbGVjdGVkIHJvd1xuICAgIEBJbnB1dCgpXG4gICAgQEhvc3RCaW5kaW5nKCdhdHRyLnNlbGVjdENvbG9yJykgc2VsZWN0Q29sb3I6IHN0cmluZztcblxuICAgIC8vIGEgdGV4dCBjb2xvciBvZiBhIHNlbGVjdGVkIHJvd1xuICAgIEBJbnB1dCgpXG4gICAgQEhvc3RCaW5kaW5nKCdhdHRyLnNlbGVjdFRleHRDb2xvcicpIHNlbGVjdFRleHRDb2xvcjogc3RyaW5nO1xuXG4gICAgLy8gYWxsb3dzIGRlc2VsZWN0aW5nIHNlbGVjdGVkIHJvd3NcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5hbGxvd0Rlc2VsZWN0aW5nUm93cycpIGFsbG93RGVzZWxlY3RpbmdSb3dzOiBib29sZWFuO1xuXG4gICAgLy8gYWxsb3dzIG5hdmlnYXRpb24gYmV0d2VlbiB0YWJsZSByb3dzIHVzaW5nIGFycm93IGtleXNcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnYXR0ci5hbGxvd0tleWJvYXJkTmF2aWdhdGlvbicpXG4gICAgYWxsb3dLZXlib2FyZE5hdmlnYXRpb24gPSB0cnVlO1xuXG4gICAgLy8gZGlzYWJsZXMgdXNlciBzZWxlY3Qgd2l0aGluZyB0aGUgdGFibGVcbiAgICBASW5wdXQoKVxuICAgIEBIb3N0QmluZGluZygnY2xhc3Mubm9UZXh0U2VsZWN0JylcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIubm9UZXh0U2VsZWN0Jykgbm9UZXh0U2VsZWN0OiBib29sZWFuO1xuXG4gICAgZml4ZWRUYWJsZUhlaWdodCA9ICdhdXRvJztcblxuICAgIEBIb3N0QmluZGluZygnYXR0ci50YWJpbmRleCcpIHRhYmluZGV4ID0gMDtcblxuICAgIHNlbGVjdGVkUm93czogQXJyYXk8bnVtYmVyPiA9IFtdO1xuXG4gICAgLy8gc3BlY2lmaWVzIGNvbGxhcHNpYmxlIHR5cGUuIENhbiBiZSBlaXRoZXIgJ2FjY29yZGlvbicgb3IgJ2V4cGFuZGFibGUnXG4gICAgQElucHV0KClcbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIudHlwZScpIHR5cGU6ICdhY2NvcmRpb24nIHwgJ2V4cGFuZGFibGUnID0gJ2FjY29yZGlvbic7XG5cbiAgICBAQ29udGVudENoaWxkcmVuKENvbGxhcHNpYmxlVGFibGVSb3dDb21wb25lbnQpIGNvbGxhcHNpYmxlVGFibGVSb3dzOiBBcnJheTxDb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50PjtcblxuICAgIG1vdXNlRG93bkhvbGQgPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmLFxuICAgICAgICBwcml2YXRlIGNvbGxhcHNpYmxlU2VydmljZTogQ29sbGFwc2libGVTZXJ2aWNlKSB7IH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgIH1cblxuICAgIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcbiAgICAgICAgLy8gdGhpcy51cGRhdGVGaXhlZFRhYmxlSGVpZ2h0KCk7XG4gICAgICAgIC8qXG4gICAgICAgIExPRyhgQ29sbGFwc2libGVUYWJsZUNvbXBvbmVudDo6bmdPbkluaXQoKVxcbmAgK1xuICAgICAgICAgICAgYHRoaXMgPSB7XFxuYCArXG4gICAgICAgICAgICBgYm9yZGVyZWQgPSAke3RoaXMuYm9yZGVyZWR9XFxuYCArXG4gICAgICAgICAgICBgYm9yZGVyZWRIb3Jpem9udGFsbHkgPSAke3RoaXMuYm9yZGVyZWRIb3Jpem9udGFsbHl9XFxuYCArXG4gICAgICAgICAgICBgYm9yZGVyZWRWZXJ0aWNhbGx5ID0gJHt0aGlzLmJvcmRlcmVkVmVydGljYWxseX1cXG5gICtcbiAgICAgICAgICAgIGBzdHJpcGVkID0gJHt0aGlzLnN0cmlwZWR9XFxuYCArXG4gICAgICAgICAgICBgc3RyaXBlZE9kZENvbG9yID0gJHt0aGlzLnN0cmlwZWRPZGRDb2xvcn1cXG5gICtcbiAgICAgICAgICAgIGBzdHJpcGVkRXZlbkNvbG9yID0gJHt0aGlzLnN0cmlwZWRFdmVuQ29sb3J9XFxuYCArXG4gICAgICAgICAgICBgaGlnaGxpZ2h0ID0gJHt0aGlzLmhpZ2hsaWdodH1cXG5gICtcbiAgICAgICAgICAgIGBoaWdobGlnaHRDb2xvciA9ICR7dGhpcy5oaWdobGlnaHRDb2xvcn1cXG5gICtcbiAgICAgICAgICAgIGBoaWdobGlnaHRUZXh0Q29sb3IgPSAke3RoaXMuaGlnaGxpZ2h0VGV4dENvbG9yfVxcbmAgK1xuICAgICAgICAgICAgYGFjdGl2ZUNvbG9yID0gJHt0aGlzLmFjdGl2ZUNvbG9yfVxcbmAgK1xuICAgICAgICAgICAgYGFjdGl2ZVRleHRDb2xvciA9ICR7dGhpcy5hY3RpdmVUZXh0Q29sb3J9XFxuYCArXG4gICAgICAgICAgICBgY2VudGVyZWQgPSAke3RoaXMuY2VudGVyZWR9XFxuYCArXG4gICAgICAgICAgICBgcmVzcG9uc2l2ZSA9ICR7dGhpcy5yZXNwb25zaXZlfVxcbmAgK1xuICAgICAgICAgICAgYHNlbGVjdCA9ICR7dGhpcy5zZWxlY3R9XFxuYCArXG4gICAgICAgICAgICBgc2VsZWN0Q29sb3IgPSAke3RoaXMuc2VsZWN0Q29sb3J9XFxuYCArXG4gICAgICAgICAgICBgc2VsZWN0VGV4dENvbG9yID0gJHt0aGlzLnNlbGVjdFRleHRDb2xvcn1cXG5gICtcbiAgICAgICAgICAgIGBzZWxlY3RNdWx0aXBsZVJvd3MgPSAke3RoaXMuc2VsZWN0TXVsdGlwbGVSb3dzfVxcbmAgK1xuICAgICAgICAgICAgYG5vVGV4dFNlbGVjdCA9ICR7dGhpcy5ub1RleHRTZWxlY3R9XFxuYCArXG4gICAgICAgICAgICBgfWApO1xuICAgICAgICAgICAgKi9cbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgY2hhbmdlIGluIGNoYW5nZXMpIHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VzLmhhc093blByb3BlcnR5KGNoYW5nZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2xsYXBzaWJsZVRhYmxlUm93cyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdHJpcGVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0cmlwZWRPZGRDb2xvcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdHJpcGVkT2RkVGV4dENvbG9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0cmlwZWRFdmVuQ29sb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3RyaXBlZEV2ZW5UZXh0Q29sb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGFibGUoJ3N0cmlwZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2hpZ2hsaWdodCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdoaWdobGlnaHRDb2xvcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdoaWdobGlnaHRUZXh0Q29sb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGFibGUoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWN0aXZlQ29sb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWN0aXZlVGV4dENvbG9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRhYmxlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NlbGVjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3RDb2xvcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3RUZXh0Q29sb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0TXVsdGlwbGVSb3dzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FsbG93RGVzZWxlY3RpbmdSb3dzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRhYmxlKCdzZWxlY3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBjb2xsYXBzaWJsZSB0YWJsZSB0eXBlIGluIENvbGxhcHNpYmxlU2VydmljZVxuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2UgPT09ICd0eXBlJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBjaGFuZ2VzLnR5cGUuY3VycmVudFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbGxhcHNpYmxlU2VydmljZS5zZXRUeXBlKHRoaXMudHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sbGFwc2libGVTZXJ2aWNlLnNldENvbGxhcHNpYmxlVGFibGUodGhpcyk7XG4gICAgfVxuXG4gICAgZm9jdXMoKSB7XG4gICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgIH1cblxuICAgIGFkZFNlbGVjdGVkUm93KGluZGV4OiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgICAgICBjYXNlIHRoaXMuc2VsZWN0TXVsdGlwbGVSb3dzICYmIHRoaXMuc2VsZWN0ZWRSb3dzLmluZGV4T2YoaW5kZXgpID09PSAtMTpcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93cy5wdXNoKGluZGV4KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93cy5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICF0aGlzLnNlbGVjdE11bHRpcGxlUm93czpcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93cyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuZGVzZWxlY3RBbGxSb3dzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd3MucHVzaChpbmRleCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd3Muc29ydCgoYSwgYikgPT4gYSAtIGIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVtb3ZlU2VsZWN0ZWRSb3coaW5kZXg6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFJvd3MuaW5kZXhPZihpbmRleCkgIT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93cy5zcGxpY2UodGhpcy5zZWxlY3RlZFJvd3MuaW5kZXhPZihpbmRleCksIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xlYXJTZWxlY3RlZFJvd3MoKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dzID0gW107XG4gICAgfVxuXG4gICAgZGVzZWxlY3RBbGxSb3dzKCkge1xuICAgICAgICB0aGlzLmNvbGxhcHNpYmxlVGFibGVSb3dzLmZvckVhY2gocm93ID0+IHtcbiAgICAgICAgICAgIHJvdy5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgcm93LnVwZGF0ZVJvdygpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZWxlY3RSb3coaW5kZXg6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3QpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgaW5kZXggPT09IDA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93KDEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGluZGV4ID09PSB0aGlzLmNvbGxhcHNpYmxlVGFibGVSb3dzLmxlbmd0aDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3codGhpcy5jb2xsYXBzaWJsZVRhYmxlUm93cy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAwIDwgaW5kZXggJiYgaW5kZXggPD0gdGhpcy5jb2xsYXBzaWJsZVRhYmxlUm93cy5sZW5ndGggLSAxOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFNlbGVjdGVkUm93KGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xsYXBzaWJsZVRhYmxlUm93cy5mb3JFYWNoKChyb3csIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3RNdWx0aXBsZVJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93LnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cuc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcm93LnVwZGF0ZVJvdygpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIHNlbGVjdFJvd3MoZmlyc3RSb3dJbmRleDogbnVtYmVyLCBsYXN0Um93SW5kZXg6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RNdWx0aXBsZVJvd3MgJiZcbiAgICAgICAgICAgIDAgPCBmaXJzdFJvd0luZGV4ICYmIGZpcnN0Um93SW5kZXggPCBsYXN0Um93SW5kZXggJiZcbiAgICAgICAgICAgIGxhc3RSb3dJbmRleCA8PSB0aGlzLmNvbGxhcHNpYmxlVGFibGVSb3dzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3RlZFJvd3MoKTtcbiAgICAgICAgICAgIHRoaXMuY29sbGFwc2libGVUYWJsZVJvd3MuZm9yRWFjaCgocm93LCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZpcnN0Um93SW5kZXggPD0gaSAmJiBpIDw9IGxhc3RSb3dJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFNlbGVjdGVkUm93KGkpO1xuICAgICAgICAgICAgICAgICAgICByb3cuc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJvdy5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByb3cudXBkYXRlUm93KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRvZ2dsZVJvd1NlbGVjdGlvbihpbmRleDogbnVtYmVyKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdCAmJlxuICAgICAgICAgICAgMCA8IGluZGV4ICYmIGluZGV4IDw9IHRoaXMuY29sbGFwc2libGVUYWJsZVJvd3MubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgdGhpcy5jb2xsYXBzaWJsZVRhYmxlUm93cy5mb3JFYWNoKChyb3csIGkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdy5zZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RlZFJvdyhpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFNlbGVjdGVkUm93KGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByb3cuc2VsZWN0ZWQgPSAhcm93LnNlbGVjdGVkO1xuICAgICAgICAgICAgICAgICAgICByb3cudXBkYXRlUm93KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKnVwZGF0ZUZpeGVkVGFibGVIZWlnaHQoKSB7XG4gICAgICAgIHRoaXMuZml4ZWRUYWJsZUhlaWdodCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQgKyAncHgnO1xuICAgICAgICBsZXQgZWxlbTogRWxlbWVudCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudDtcbiAgICAgICAgbGV0IHJvd0hlaWdodHMgPSAwO1xuICAgICAgICBpZiAodGhpcy5jb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuY29sbGFwc2libGVUYWJsZVJvd0NvbXBvbmVudC5mb3JFYWNoKHJvdyA9PiB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0qL1xuXG4gICAgdXBkYXRlU3RyaXBlZChyb3c6IENvbGxhcHNpYmxlVGFibGVSb3dDb21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3RyaXBlZCAmJiByb3cuaXNCb2R5Um93KSB7XG4gICAgICAgICAgICByb3cuaXNQYXJlbnRTdHJpcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChyb3cuaXNPZGRSb3cpIHtcbiAgICAgICAgICAgICAgICByb3cucGFyZW50U3RyaXBlZFJvd0JhY2tncm91bmRDb2xvciA9IHRoaXMuc3RyaXBlZE9kZENvbG9yIHx8IENvbGxhcHNpYmxlVGFibGVSb3dDb21wb25lbnQuREVGQVVMVF9TVFJJUEVEX09ERF9ST1dfQ09MT1I7XG4gICAgICAgICAgICAgICAgcm93LnBhcmVudFN0cmlwZWRSb3dUZXh0Q29sb3IgPSB0aGlzLnN0cmlwZWRPZGRUZXh0Q29sb3IgfHwgQ29sbGFwc2libGVUYWJsZVJvd0NvbXBvbmVudC5ERUZBVUxUX1JPV19URVhUX0NPTE9SO1xuICAgICAgICAgICAgICAgIHJvdy5yb3dCYWNrZ3JvdW5kQ29sb3IgPSByb3cucGFyZW50U3RyaXBlZFJvd0JhY2tncm91bmRDb2xvcjtcbiAgICAgICAgICAgICAgICByb3cucm93VGV4dENvbG9yID0gcm93LnBhcmVudFN0cmlwZWRSb3dUZXh0Q29sb3I7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJvdy5wYXJlbnRTdHJpcGVkUm93QmFja2dyb3VuZENvbG9yID0gdGhpcy5zdHJpcGVkRXZlbkNvbG9yIHx8IENvbGxhcHNpYmxlVGFibGVSb3dDb21wb25lbnQuREVGQVVMVF9TVFJJUEVEX0VWRU5fUk9XX0NPTE9SO1xuICAgICAgICAgICAgICAgIHJvdy5wYXJlbnRTdHJpcGVkUm93VGV4dENvbG9yID0gdGhpcy5zdHJpcGVkRXZlblRleHRDb2xvciB8fCBDb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50LkRFRkFVTFRfUk9XX1RFWFRfQ09MT1I7XG4gICAgICAgICAgICAgICAgcm93LnJvd0JhY2tncm91bmRDb2xvciA9IHJvdy5wYXJlbnRTdHJpcGVkUm93QmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgICAgIHJvdy5yb3dUZXh0Q29sb3IgPSByb3cucGFyZW50U3RyaXBlZFJvd1RleHRDb2xvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJvdy5pc1BhcmVudFN0cmlwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJvdy5yb3dCYWNrZ3JvdW5kQ29sb3IgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICByb3cucm93VGV4dENvbG9yID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdXBkYXRlSGlnaGxpZ2h0KHJvdzogQ29sbGFwc2libGVUYWJsZVJvd0NvbXBvbmVudCk6IHZvaWQge1xuICAgICAgICByb3cuaXNQYXJlbnRIaWdobGlnaHQgPSB0aGlzLmhpZ2hsaWdodDtcbiAgICAgICAgcm93LnBhcmVudEhpZ2hsaWdodFJvd0JhY2tncm91bmRDb2xvciA9IHRoaXMuaGlnaGxpZ2h0Q29sb3IgfHwgQ29sbGFwc2libGVUYWJsZVJvd0NvbXBvbmVudC5ERUZBVUxUX0hJR0hMSUdIVF9ST1dfQ09MT1I7XG4gICAgICAgIHJvdy5wYXJlbnRIaWdobGlnaHRSb3dUZXh0Q29sb3IgPSB0aGlzLmhpZ2hsaWdodFRleHRDb2xvciB8fCBDb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50LkRFRkFVTFRfUk9XX1RFWFRfQ09MT1I7XG4gICAgfVxuXG4gICAgdXBkYXRlQWN0aXZlKHJvdzogQ29sbGFwc2libGVUYWJsZVJvd0NvbXBvbmVudCk6IHZvaWQge1xuICAgICAgICByb3cuYWN0aXZlUm93QmFja2dyb3VuZENvbG9yID0gdGhpcy5hY3RpdmVDb2xvciB8fCBDb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50LkRFRkFVTFRfQUNUSVZFX1JPV19DT0xPUjtcbiAgICAgICAgcm93LmFjdGl2ZVJvd1RleHRDb2xvciA9IHRoaXMuYWN0aXZlVGV4dENvbG9yIHx8IENvbGxhcHNpYmxlVGFibGVSb3dDb21wb25lbnQuREVGQVVMVF9ST1dfVEVYVF9DT0xPUjtcbiAgICB9XG5cbiAgICB1cGRhdGVTZWxlY3Qocm93OiBDb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50KTogdm9pZCB7XG4gICAgICAgIHJvdy5wYXJlbnRBbGxvd3NTZWxlY3QgPSB0aGlzLnNlbGVjdDtcbiAgICAgICAgcm93LnBhcmVudEFsbG93c1NlbGVjdE11bHRpcGxlUm93cyA9IHRoaXMuc2VsZWN0TXVsdGlwbGVSb3dzO1xuICAgICAgICByb3cucGFyZW50QWxsb3dzRGVzZWxlY3RpbmdSb3dzID0gdGhpcy5hbGxvd0Rlc2VsZWN0aW5nUm93cztcbiAgICAgICAgaWYgKHJvdy5zZWxlY3RlZCkge1xuICAgICAgICAgICAgcm93LnNlbGVjdGVkUm93QmFja2dyb3VuZENvbG9yID0gdGhpcy5zZWxlY3RDb2xvciB8fCBDb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50LkRFRkFVTFRfU0VMRUNURURfUk9XX0NPTE9SO1xuICAgICAgICAgICAgcm93LnNlbGVjdGVkUm93VGV4dENvbG9yID0gdGhpcy5zZWxlY3RUZXh0Q29sb3IgfHwgQ29sbGFwc2libGVUYWJsZVJvd0NvbXBvbmVudC5ERUZBVUxUX1JPV19URVhUX0NPTE9SO1xuICAgICAgICAgICAgcm93LnJvd0JhY2tncm91bmRDb2xvciA9IHJvdy5zZWxlY3RlZFJvd0JhY2tncm91bmRDb2xvcjtcbiAgICAgICAgICAgIHJvdy5yb3dUZXh0Q29sb3IgPSByb3cuc2VsZWN0ZWRSb3dUZXh0Q29sb3I7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB1cGRhdGVUYWJsZShjaGFuZ2U/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuY29sbGFwc2libGVUYWJsZVJvd3MgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKGNoYW5nZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChjaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3RyaXBlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcm9wYWdhdGUgY2hhbmdlcyB0byBlYWNoIG9mIHRoZSBDb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50IGNoaWxkcmVuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbGxhcHNpYmxlVGFibGVSb3dzLmZvckVhY2gocm93ID0+IHsgdGhpcy51cGRhdGVTdHJpcGVkKHJvdyk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2hpZ2hsaWdodCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbGxhcHNpYmxlVGFibGVSb3dzLmZvckVhY2gocm93ID0+IHsgdGhpcy51cGRhdGVIaWdobGlnaHQocm93KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWN0aXZlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29sbGFwc2libGVUYWJsZVJvd3MuZm9yRWFjaChyb3cgPT4geyB0aGlzLnVwZGF0ZUFjdGl2ZShyb3cpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xsYXBzaWJsZVRhYmxlUm93cy5mb3JFYWNoKHJvdyA9PiB7IHRoaXMudXBkYXRlU2VsZWN0KHJvdyk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBwcm9wYWdhdGUgY2hhbmdlcyB0byBlYWNoIG9mIHRoZSBDb2xsYXBzaWJsZVRhYmxlUm93Q29tcG9uZW50IGNoaWxkcmVuXG4gICAgICAgICAgICAgICAgdGhpcy5jb2xsYXBzaWJsZVRhYmxlUm93cy5mb3JFYWNoKHJvdyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RyaXBlZChyb3cpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUhpZ2hsaWdodChyb3cpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdChyb3cpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUFjdGl2ZShyb3cpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgQEhvc3RMaXN0ZW5lcigna2V5ZG93bicsIFsnJGV2ZW50J10pXG4gICAga2V5ZG93bihldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICAvLyBzZWxlY3QgYSByb3cgb25seSBpZiAnc2VsZWN0JyBwcm9wZXJ0eSBpcyBzZXQgdG8gJ3RydWUnXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdCAmJiB0aGlzLmFsbG93S2V5Ym9hcmROYXZpZ2F0aW9uKSB7XG4gICAgICAgICAgICBlbnVtIEtleSB7XG4gICAgICAgICAgICAgICAgYXJyb3dVcCA9IDM4LFxuICAgICAgICAgICAgICAgIGFycm93RG93biA9IDQwLFxuICAgICAgICAgICAgICAgIGhvbWUgPSAzNixcbiAgICAgICAgICAgICAgICBlbmQgPSAzNVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgaW5kZXggPSAxO1xuICAgICAgICAgICAgY29uc3Qgd2hpY2hLZXkgPSBldmVudFsnd2hpY2gnXTtcbiAgICAgICAgICAgIGlmIChLZXlbd2hpY2hLZXldICE9IG51bGwpIHtcblxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHdoaWNoS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgS2V5LmFycm93VXA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxlY3QgcHJldmlvdXMgcm93XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFJvd3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5zZWxlY3RlZFJvd3NbdGhpcy5zZWxlY3RlZFJvd3MubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIEtleS5hcnJvd0Rvd246XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxlY3QgbmV4dCByb3dcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUm93cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLnNlbGVjdGVkUm93c1t0aGlzLnNlbGVjdGVkUm93cy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgS2V5LmhvbWU6XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBLZXkuZW5kOlxuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLmNvbGxhcHNpYmxlVGFibGVSb3dzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyU2VsZWN0ZWRSb3dzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXNlbGVjdEFsbFJvd3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFJvdyhpbmRleCk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUYWJsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgQEhvc3RMaXN0ZW5lcignbW91c2Vkb3duJylcbiAgICBtb3VzZWRvd24oKSB7XG4gICAgICAgIHRoaXMubW91c2VEb3duSG9sZCA9IHRydWU7XG4gICAgfVxuXG4gICAgQEhvc3RMaXN0ZW5lcignbW91c2V1cCcpXG4gICAgbW91c2V1cCgpIHtcbiAgICAgICAgdGhpcy5tb3VzZURvd25Ib2xkID0gZmFsc2U7XG4gICAgfVxufVxuIl19